%monolix parameter distributions
%figure 3

%% Netherlands
mu_beta = log(4.66E-05); sigma_beta = 2.630381112; %monolix pop fit estimate
x_beta=-16:(-5+16)/100:-5; %parameter limits
pd_beta = makedist('Normal','mu',mu_beta,'sigma',sigma_beta);
pdf_beta = pdf(pd_beta,x_beta);
b_vec=[1.61E-05 %monolix sampled beta
8.63E-06
5.02E-05
5.42E-05
1.59E-05
3.14E-05
1.82E-06
9.06E-05
1.94E-05
2.96E-05
1.09E-06
2.09E-06
2.13E-06
1.61E-06
1.42E-06
9.14E-07
2.27E-06
1.70E-06
2.42E-06
1.01E-06
2.80E-05
6.12E-06
3.44E-05
1.02E-05
7.79E-06
2.20E-05
4.74E-06
1.42E-05
2.40E-05
1.45E-05
0.00162192
0.001371135
0.001036715
0.001509647
0.001629471
0.000765231
0.001644073
0.001621168
0.002093307
0.001936966
0.000598217
0.000911029
0.000356682
0.000470336
0.000996994
0.00053013
0.000925985
0.000412804
0.000377471
0.000628182
0.001498682
0.000321964
0.001912638
0.001744643
0.001050841
0.00178046
0.000569236
0.001024534
0.000970132
0.001144661
3.75E-06
2.66E-06
1.91E-06
9.32E-07
1.71E-06
3.02E-06
2.37E-06
1.59E-06
7.53E-07
2.76E-06
0.002418042
0.000709887
0.00203724
0.001063598
0.000380922
0.001389882
0.002093136
0.001481287
0.000940237
0.000716507
0.000167198
4.64E-05
9.69E-05
7.58E-05
0.000100833
0.000104945
2.74E-05
0.000160353
6.74E-05
8.80E-05
3.08E-06
1.13E-06
2.71E-06
1.00E-06
1.27E-06
4.64E-06
1.68E-06
4.18E-06
2.53E-06
1.53E-06];

mu_delta = log(6.945069905); sigma_delta = 0.156123757;%monolix pop fit estimate
x_delta=3.20144:(15.0663-3.20144)/100:15.0663;%parameter limits
pd_delta = makedist('LogNormal','mu',mu_delta,'sigma',sigma_delta);
pdf_delta = pdf(pd_delta,x_delta);
bins_data_delta=[5.52874	0.210535 %monolix pre-binned sampled delta
6.05122	0.273696
6.5737	0.463177
7.09617	0.463177
7.61865	0.315803
8.14113	0.168428
8.66361	0.126321
9.18609	0.0631605
9.70857	0
10.231	0.0210535];

mu_c = log(48.8153521); sigma_c = 1.214357486;%monolix pop fit estimate
x_c=50:(2245.51-50)/100:2245.51;%parameter limits
pd_c = makedist('LogNormal','mu',mu_c,'sigma',sigma_c);
pdf_c = pdf(pd_c,x_c);
c_vec=[16.90809487%monolix sampled c
7.982505088
3.610657465
3.136610582
60.43051866
2245.5121
24.80444782
14.26277927
6.18969955
56.07082311
24.31227911
14.78217227
12.22917465
8.340316085
30.28529004
59.37961886
15.76174164
29.1552561
8.437671234
30.62132229
357.933752
72.3967112
49.31863676
126.6229947
28.84478512
468.0338184
104.3534111
7.997435199
35.28465725
47.90368589
315.0438131
150.3047126
65.63968028
131.401004
35.78902276
120.4196845
66.18351068
10.21543654
32.87835441
10.67041273
370.2802722
84.20710092
49.48414083
199.7955222
27.07587439
70.04309938
74.02878227
19.38274762
89.3298858
26.09551613
284.2109896
161.7617213
135.9822685
218.527072
54.87736782
157.4340013
76.65594556
79.9455422
160.9716373
33.13419413
18.60289968
5.92820778
112.2137404
56.48037481
19.78083234
20.37967636
37.19428564
72.49742111
73.60375025
25.14407831
131.1377642
393.0361547
145.483104
28.79396692
31.9469097
354.7432591
228.1262977
429.4025567
22.66904449
268.1489787
16.95363199
84.25274425
8.688087968
95.83936253
80.55796948
19.87949237
63.70377298
4.805570939
26.93298789
96.36016816
10.27092995
9.929952276
32.19436015
19.82800127
80.7529956
8.994426873
15.69239536
9.419305203
11.36844126
50.67874535];

mu_p = log(7.486610076); sigma_p = 2.656083406;%monolix pop fit estimate
x_p=1:(812.355-1)/100:812.355;%parameter limits
pd_p = makedist('LogNormal','mu',mu_p,'sigma',sigma_p);
pdf_p = pdf(pd_p,x_p);
p_vec=[9.256157927%monolix sampled p
11.49073664
35.33530049
24.71300834
30.67205525
531.9556679
273.0847748
0.935261098
3.153859328
9.554640372
295.1873157
97.07895526
94.97709087
115.3328228
300.7209752
812.3550523
86.443287
167.097603
77.27015445
278.8344739
76.99902294
53.60606585
6.428826941
54.96311425
17.74774056
121.6112637
136.3437383
3.046776606
7.980702348
16.42776675
0.906038824
0.390798976
0.367453669
0.344263311
0.08757367
0.726486907
0.152011524
0.029057812
0.059139499
0.022312939
3.554212076
0.369733789
0.598379899
1.973319071
0.1331113
0.557842629
0.296409286
0.201672086
1.285164165
0.139837681
0.686447162
2.95778729
0.229341517
0.437838856
0.186090596
0.360931661
0.562128009
0.320974383
0.638729687
0.115290381
46.48912946
26.06195032
517.0626062
529.8147306
100.1130597
48.89617968
120.1923137
328.3850502
732.7401406
63.56856475
0.211072292
2.494673719
0.255538861
0.157799332
98.14427457
1.141184467
0.447661322
1.952180016
0.10006585
1.386807565
0.544864206
8.246808066
0.433188249
5.327855257
3.25205994
0.923578541
9.890408518
0.176280469
1.615451454
5.749811922
51.70402379
96.30130589
93.33990788
217.7377518
557.7447939
29.95237347
77.7247431
32.5797472
57.25697787
290.7325891];

mu_k = log(7.072362766); sigma_k = 0.236717946;%monolix pop fit estimate
x_k=2.72536:(18.3529-2.72536)/100:18.3529;%parameter limits
pd_k = makedist('LogNormal','mu',mu_k,'sigma',sigma_k);
pdf_k = pdf(pd_k,x_k);
bins_data_k=[4.01507	0.0423603%monolix pre-binned sampled k
4.7941	0.0706005
5.57313	0.225922
6.35216	0.225922
7.1312	0.282402
7.91023	0.225922
8.68926	0.169441
9.46829	0.0988407
10.2473	0.0423603
11.0264	0.0282402];

%plot pdf with sampled parameter densities
figure(2)
subplot(2,3,1)
histogram(log(b_vec),'Normalization','pdf','BinWidth',1);
hold on
plot(x_beta,pdf_beta,'Linewidth',1.5)
hold on

subplot(2,3,2)
bar(bins_data_delta(:,1), bins_data_delta(:,2), 'BarWidth', 1);
hold on
plot(x_delta,pdf_delta,'Linewidth',1.5)
hold on

subplot(2,3,3)
histogram(c_vec,'Normalization','pdf','BinWidth',50);
hold on
plot(x_c,pdf_c,'Linewidth',1.5)
hold on

subplot(2,3,4)
histogram(p_vec,'Normalization','pdf','BinWidth',50);
hold on
plot(x_p,pdf_p,'Linewidth',1.5)
hold on

subplot(2,3,5)
bar(bins_data_k(:,1), bins_data_k(:,2), 'BarWidth', 1);
hold on
plot(x_k,pdf_k,'Linewidth',1.5)
hold on

%% Uganda (without bird 8)

mu_beta = log(1.42E-04); sigma_beta = 2.683725036;
x_beta=-14:(-3.5+14)/100:-3.5;
pd_beta = makedist('Normal','mu',mu_beta,'sigma',sigma_beta);
pdf_beta = pdf(pd_beta,(x_beta));
b_vec=[0.000331885
0.000277727
0.000133733
0.000166476
9.30E-06
0.000490462
6.48E-05
9.23E-05
8.70E-06
0.000236157
3.66E-06
3.66E-06
7.65E-06
3.31E-06
6.50E-06
2.91E-06
4.12E-06
1.94E-06
2.34E-06
6.64E-06
0.000572563
0.000553243
0.001223368
0.003032727
0.012845872
0.000627565
0.000191625
0.001267372
0.000271586
0.000385021
0.000153803
2.58E-05
0.000169904
3.21E-05
0.000134112
6.48E-05
5.12E-05
2.22E-05
0.000448231
0.002197621
0.00147076
0.00010885
0.000959419
0.006154473
0.000529225
0.005235244
0.000304927
0.002492976
0.001353892];

mu_delta = log(6.742574241); sigma_delta = 0.463132366;
x_delta=1.77644:(25.5918-1.77644)/100:25.5918;
pd_delta = makedist('LogNormal','mu',mu_delta,'sigma',sigma_delta);
pdf_delta = pdf(pd_delta,x_delta);
bins_data_delta=[2.59237	0.0673168
3.92933	0.151463
5.2663	0.235609
6.60326	0.084146
7.94022	0.168292
9.27718	0.0336584
10.6141	0.0336584
11.9511	0.0673168];

mu_c = log(35.79268977); sigma_c = 2.82582157;
x_c=75:(5000-75)/100:5000;
pd_c = makedist('LogNormal','mu',mu_c,'sigma',sigma_c);
pdf_c = pdf(pd_c,x_c);
c_vec=[660.6236754
942.9832374
925.2442903
1562.134163
12.11011441
580.1184662
321.1685632
633.5917184
33.92722014
842.2760485
0.829555894
0.652049206
0.09175529
1.295346303
0.224480836
1.029368985
0.427987594
1.586632255
2.721302987
0.230542359
472.3256145
79.78938136
574.7484232
63.4570912
180.2479793
59.59613389
88.16554851
19.28738811
12.74706303
391.3120782
29.29023814
7.459920814
90.7068389
104.4559053
8.720004782
26.69270328
70.12675727
13.2672317
28.18929638
42.59513078
4273.782568
2868.440808
185.3521117
132.8459671
1120.649162
657.2550408
760.1076939
1566.807798
749.1451908];

mu_p = log(18.19087424); sigma_p = 0.738398344;
x_p=3.3761:(218.533-3.3761)/100:218.533;
pd_p = makedist('LogNormal','mu',mu_p,'sigma',sigma_p);
pdf_p = pdf(pd_p,x_p);
bins_data_p=[17.2791	0.0293472
44.113	0.00922341
70.9469	0.00251548
97.7808	0
124.615	0
151.449	0
178.282	0
205.116	0.000838492];

mu_k = log(3.356925808); sigma_k = 0.213864006;
x_k=1.35613:(8.30967-1.35613)/100:8.30967;
pd_k = makedist('LogNormal','mu',mu_k,'sigma',sigma_k);
pdf_k = pdf(pd_k,x_k);
bins_data_k=[2.27237	0.339364
2.60387	0.339364
2.93538	0.407237
3.26688	0.407237
3.59838	0.882347
3.92988	0.47511
4.26138	0.203619
4.59289	0.339364];

figure(1)
subplot(2,3,1)
histogram(log(b_vec),'Normalization','pdf','BinWidth',1);
hold on
plot((x_beta),pdf_beta,'Linewidth',1.5)
hold on

subplot(2,3,2)
bar(bins_data_delta(:,1), bins_data_delta(:,2), 'BarWidth', 1);
hold on
plot(x_delta,pdf_delta,'Linewidth',1.5)
hold on

subplot(2,3,3)
histogram(c_vec,'Normalization','pdf','BinWidth',150);
hold on
plot(x_c,pdf_c,'Linewidth',1.5)
hold on

subplot(2,3,4)
bar(bins_data_p(:,1), bins_data_p(:,2), 'BarWidth', 1);
hold on
plot(x_p,pdf_p,'Linewidth',1.5)
hold on

subplot(2,3,5)
bar(bins_data_k(:,1), bins_data_k(:,2), 'BarWidth', 1);
hold on
plot(x_k,pdf_k,'Linewidth',1.5)
hold on